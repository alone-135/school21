# C4 Report

## Part 1. Установка ОС

- ### Вывод версии ОС

    ```
    cat /etc/issue
    ```

    <img src="images/os_vers.png" alt="Вывод версии ОС" width="">

<br/>

----------------------------------------------------

<br/>

## Part 2. Создание пользователя 

-   ### Создание пользователя `user-1` и добавление его в группу `adm` (-G adm), а также создание домашней деректории нового пользователя (-m)
    
    ```
    sudo useradd -m -G adm user-1
    ```

    <img src="images/add_user.png" alt="Создание пользователя" width="">

<br/>

---
-   ### Вывод списка пользователей
    
    ```
    cat /etc/passwd
    ```

    <img src="images/user_list.png" alt="Вывод списка пользователей" width="">

<br/>

----------------------------------------------------

<br/>

## Part 3. Настройка сети ОС

- ### Изменение названия машины на `user-1`  
    <br/>
    1. С помощью данных команд поочерёдно замените старое название вашего сервера на новое в файлах `hostname` и `hosts`

    ```
    sudo vim /etc/hostname
    ```

    ```
    sudo vim /etc/hosts
    ```
    2. Перезагрузите сервер при помощи команды

    ```
    sudo reboot
    ```
    ---
    <br/>
- ###  Установить временную зону, соответствующую вашему текущему местоположению.
    <br/>

    Чтобы установить московский часовой пояс введите следующую команду:
    ```
    sudo timedatectl set-timezone Europe/Moscow
    ```
    <br/>

    Для проверки текущих настроек даты и времени используйте команду:

    ```
    timedatectl
    ```
    ---
    <br/>
- ### Вывести названия сетевых интерфейсов с помощью консольной команды.
    <br/>
    Команда для вывода сетевых интерфейсов

    ```
    ip -br link show
    ```

    <img src="images/link_show.png" alt="Вывод сетевых интерфейсов" width="">


    lo (loopback) - это официальный стандарт, неотъемлемая часть unix/  linux системы. Нужен для  работы многих приложений, для тестирования итд.
---
<br/>

- ### Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера.
    <br/>
     DHCP (Dynamic Host Configuration Protocol — протокол динамической настройки узла)

    <br>
    Освобождаем текущий ip адресс

    ```
    sudo dhclient -r
    ```

    Запрашиваем и получаем новый ip адресс

    ```
    sudo dhclient
    ```

---
<br/>

- ### Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw).
    <br>
    Внешний адрес (IP)

    ```
    hostname -I
    ```

    Адрес шлюза

    ```
    routel | grep default
    ```
    

---
<br/>

- ### Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).
    <br>

    1.  Открываем файл для редактирования

        ```
        sudo vi /etc/netplan/*.yaml
        ```

    ---
    2. Замняем его внутриности на это

     <img  src="images/change_ip.png" alt="Меняем внутриности">
        
    ---
    
    3. Сохраняем изменения

    ```
    sudo netplan apply
    ```

---
<br/>

- ### Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.

    <br>

    Перезагрузить сервер

    ```
    reboot
    ```
    ---
    Проверить новый айпишник

    ```
    hostname -I
    ```
    ---
    Результат пинга `1.1.1.1` и `ya.ru`

    <img src="images/ping_test.png" alt="пингуем!">

<br/>

----------------------------------------------------

<br/>

## Part 4. Обновление ОС

- ###  Нет обновлений (
     <img src="images/no_update.png">
    
<br/>

----------------------------------------------------

<br/>

## Part 5. Использование команды sudo

- ###  Что за зверь такой, этот ваш `sudo`?
    sudo — это важная для понимания утилита, она позволяет временно поднимать привилегии и выполнять задачи администрирования системы. Суть в том, что в каждом дистрибутиве Linux есть пользователь root, имеющий максимальные права .

    Однако во имя безопасности его часто отключают, поскольку он действительно может делать все что угодно в рамках системы . А Linux, как известно, не спрашивает, хотите ли вы точно-точно-точно удалить самый важный файл — система просто молча удаляет его, после чего начинается веселый квест с восстановлением.

    Потому, как сказано выше, учетная запись root по дефолту отключена, чтобы неопытные пользователи не смогли нарушить работу системы. А для некоторых административных задач, где требуются повышенные привилегии, используется временное решение — sudo.

    Эту утилиту можно сравнить с UAC в Windows — тем самым контролем учетных записей пользователей. Только в Windows система сама сообщает, когда та или иная программа пытается внести изменения в систему, а в Linux команду надо вводить самому.

    <img src="images/this_is_SUDO.jpeg">

---

<br>

- ###  Хостнейм изменён
     <img src="images/change_hostname.png" alt="Изменённый хостнейм">
    
<br/>

----------------------------------------------------

<br/>

## Part 6. Установка и настройка службы времени

- ### CUR_TIME )
<img src="images/cur_time.png" alt="тута далжно быть влемя )))">
    
<br/>

----------------------------------------------------

<br/>

## Part 7. Установка и использование текстовых редакторов

- ### VIM

    Содержимое файла перед закрытием
    <img src="images/vim_save.png" alt="vim_save">
    <br>
    
    Закрытие редактора с сохранением
    ```
    [esc] -> :wq -> [enter]
    ```
    <br>

    Содержимое файла перед закрытием без сохранения
    <img src="images/vim_unsave.png" alt="vim_unsave">
    <br>
    
    Закрытие редактора без сохранения
    
    ```
    [esc] -> :q! -> [enter]
    ```
    <br>

    Поиск слова в файле
    <img src="images/vim_search.png" alt="vim_search">
    <br>

    Поиск и замена слова в файле
    <img src="images/vim_replace.png" alt="vim_replace">
    <br>
    
    ---
<br>

- ### NANO

    Содержимое файла перед закрытием
    <img src="images/nano_save.png" alt="nano_save">
    <br>
    
    Закрытие редактора с сохранением
    ```
    [^]+[x] -> [y] -> [enter]
    ```
    <br>

    Содержимое файла перед закрытием без сохранения
    <img src="images/nano_unsave.png" alt="nano_unsave">
    <br>
    
    Закрытие редактора без сохранения
    
    ```
    [^]+[x] -> [n]
    ```
    <br>

    Поиск слова в файле
    <img src="images/nano_search.png" alt="nano_search">
    <br>

    Поиск и замена слова в файле
    <img src="images/nano_replace1.png" alt="nano_replace1">
    <img src="images/nano_replace2.png" alt="nano_replace2">
    <img src="images/nano_replace3.png" alt="nano_replace3">
    <img src="images/nano_replace4.png" alt="nano_replace4">
    <img src="images/nano_replace5.png" alt="nano_replace5">
    <br>
    
    ---
<br>

- ### MCEDIT
     Содержимое файла перед закрытием
    <img src="images/mcedit_save.png" alt="mcedit_save">
    <br>
    
    Закрытие редактора с сохранением
    ```
    [fn]+[F10] -> [->] -> [enter]
    ```
    <br>

    Содержимое файла перед закрытием без сохранения
    <img src="images/mcedit_unsave.png" alt="mcedit_unsave">
    <br>
    
    Закрытие редактора без сохранения
    
    ```
    [fn]+[F10] -> [<-] -> [enter]
    ```
    <br>

    Поиск слова в файле
    <img src="images/mcedit_search.png" alt="mcedit_search">
    <br>

    Поиск и замена слова в файле
    <img src="images/mcedit_replace1.png" alt="mcedit_replace1">
    <br>
    <img src="images/mcedit_replace2.png" alt="mcedit_replace2">
    <br>
    <img src="images/mcedit_replace3.png" alt="mcedit_replace3">
    <br>
    <img src="images/mcedit_replace4.png" alt="mcedit_replace4">
    <br>
    
    ---
<br>
    
<br/>

----------------------------------------------------

<br/>

## Part 8. Установка и базовая настройка сервиса SSHD


- ### Установить службу SSHd.
    Команда для устрановки службы

    ```
    sudo apt install openssh-server
    ```

---
<br>

- ### Добавить автостарт службы при загрузке системы.
    Команда для добавления службы в автозагрузку

    ```
    sudo systemctl enable ssh
    ```

---
<br>

- ### Перенастроить службу SSHd на порт 2022.

    Изменить в файле `/etc/ssh/sshd_config` строку 
    
    ```
    # Port 22
    ```
    на  
    ```
    Port 2022
    ```


---
<br>

- ###    Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.

    Запускаем команду 
    ```
    ps -aux | grep sshd
    ```
    Здесь:  
    -a - выбрать все процессы, кроме фоновых  
    -u - выбрать процессы пользователя  
    -x - процессы, отсоединённые от терминала


---
<br>

- ### Перезагрузить систему.
    В команде `netstat -tan`:  
    -a - писок всех портов (как TCP, так и UDP)
    -t - Список соединений TCP (Transmission Control Protocol)  
    -n - Показываen числовые адреса вместо того, чтобы пытаться определить символические имена хостов, портов или пользователей.
    
    <img src="images/port_check.png" alt="port_check">

     
    Proto - Имя протокола (TCP или UDP).

    В колонках Recv-Q и Send-Q отображается количество запросов в очередях на приём и отправку на данном узле/компьютере.  

    Local Address - IP-адрес локального компьютера и используемый номер порта. Имя локального компьютера, соответствующее IP-адресу и имя порта, отображается, если не указан параметр -n . Если порт еще не установлен, номер порта отображается в виде звездочки (*).  
    
    Foreign Address - IP-адрес и номер порта удаленного компьютера, к которому подключен сокет. Имена, соответствующие IP-адресу и порту, отображаются, если не указан параметр -n . Если порт еще не установлен, номер порта отображается в виде звездочки (*).

    State - Указывает состояние TCP-подключения
    
<br/>

----------------------------------------------------

<br/>

## Part 9. Установка и использование утилит top, htop

- ### По выводу команды top определить и написать в отчёте:

    <img src="images/top.png" alt="top">

    - uptime

    ```
    53 min
    ```
    - количество авторизованных пользователей

    ```
    1
    ```
    - общая загрузка системы

    ```
    1
    ```
    - общее количество процессов

    ```
    96
    ```
    - загрузка cpu

    ```
    0.3
    ```
    - загрузка памяти

    ``` 
    137.8
    ```
    - pid процесса занимающего больше всего памяти

    ```
    1
    ```
    - pid процесса, занимающего больше всего процессорного времени

    ```
    1
    ```
---
<br>

- ### В отчёт вставить скрин с выводом команды htop:

    - отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
    
    <img src="images/htop_pid.png" alt="htop_pid">
    <img src="images/htop_cpu.png" alt="htop_cpu">
    <img src="images/htop_mem.png" alt="htop_mem">
    <img src="images/htop_time.png" alt="htop_time">

    - отфильтрованному для процесса sshd
    <img src="images/htop_sshd.png" alt="htop_sshd">

    - с процессом syslog, найденным, используя поиск
    <img src="images/htop_syslog.png" alt="htop_syslog">

    - с добавленным выводом hostname, clock и uptime
    <img src="images/htop_plus.png" alt="htop_plus">

<br/>

----------------------------------------------------

<br/>

## Part 10. Использование утилиты fdisk

- ### Запустить команду fdisk -l.

    <img src="images/disk.png" alt="disk_info">

    - Название диска

    ```
    /dev/sda
    ```

    - Размер диска

    ```
    81.79 GiB (87803559936 bites)
    ```

    - Количество секторов диска

    ```
    171491328 
    ```

    - Размер swap

    ```
    4 GiB
    ```
    
<br/>

----------------------------------------------------

<br/>

## Part 11. Использование утилиты df 


- ### Запустить команду df.

    <img src="images/df.png" alt="df">

    Корневой раздел (/):
    - размер раздела - `41109928`

    - размер занятого пространства - `6671820`

    - размер свободного пространства - `32317612`

    - процент использования - `18%`


    <br>

    Единица измерения в выводе - `KB (килобайт)`

---
<br>

- ### Запустить команду df -Th.

    <img src="images/df_Th.png" alt="df_Th">

    Корневой раздел (/):
    - размер раздела - `40G`

    - размер занятого пространства - `6.4G`

    - размер свободного пространства - `31G`

    - процент использования - `18%`


    <br>

    Тип файловой системы - `/dev/mapper/ubuntu--vg-ubuntu--lv`

    
<br/>

----------------------------------------------------

<br/>

## Part 12. Использование утилиты du 

- ### Запустить команду du.
    <img src="images/du.png" alt="du">

    ---
<br>

- ### Вывести размер папок /home, /var, /var/log (в байтах, в     человекочитаемом виде)

    <img src="images/du_home.png" alt="du_home">
    <img src="images/du_var.png" alt="du_var">
    <img src="images/du_var_log.png" alt="du_var_log">

    ---
<br>

- ### Вывести размер всего содержимого в /var/log (не общее, а    каждого вложенного элемента, используя *)

    <img src="images/du_var_log_.png" alt="du_var_log/">

----------------------------------------------------

<br/>

## Part 13. Установка и использование утилиты ncdu

- ### Установить утилиту ncdu.

    Команда для установки
    ```
    sudo apt install ncdu
    ```

    ---
<br>

- ### Вывести размер папок /home, /var, /var/log.

    <img src="images/ncdu_home.png" alt="ncdu_home">
    <img src="images/ncdu_var.png" alt="ncdu_var">
    <img src="images/ncdu_var_log.png" alt="ncdu_var_log">


    
<br/>

----------------------------------------------------

<br/>

## Part 14. Работа с системными журналами

- ### Открыть для просмотра:

    1. /var/log/dmesg

    2. /var/log/syslog

    3. /var/log/auth.log

    Написать в отчёте время последней успешной авторизации, имя пользователя и метод входа в систему.  
    <img src="images/last_login.png" alt="last_login">
    - Имя пользователя - `alone`
    - Время - `16:31`
    - Метод входа - `tty1`

    Перезапустить службу SSHd.
    ```
    sudo systemctl restart sshd
    ```

    Вставить в отчёт скрин с сообщением о рестарте службы (искать в логах).
    <img src="images/sshd_log.png" alt="sshd_log">





    
<br/>

----------------------------------------------------

<br/>

## Part 15. Использование планировщика заданий CRON

- ### Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.

    Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении.

    <img src="images/cron_log.png" alt="cron_log">

    Вывести на экран список текущих заданий для CRON.

    <img src="images/cron_list.png" alt="cron_list">


---
<br>

- ### Удалите все задания из планировщика заданий.

   <img src="images/cron_emp.png" alt="cron_emp">
    
<br/>

----------------------------------------------------
